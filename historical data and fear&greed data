# @title convert csv into df
import pandas as pd
df = pd.read_csv('Coffe_sales.csv')
df

# @title checking size of dataset
print("no.of rows is ",df.shape[0])
print("no.of columns is ",df.shape[1])

df.info()

df.describe()

# @title checking for null values
df.isnull().sum()

# @title Q1 sales vary by time of day
pd.unique(df['Time_of_Day'])
df['Time_of_Day'].value_counts().reset_index()

# @title Q2 coffee_name has the highest number of sales
pd.unique(df['coffee_name'])
df['coffee_name'].value_counts().reset_index()

# @title Q3 peak sales hours of a day(hour_of_day)
peak_sal = df['hour_of_day'].max()
df[df['hour_of_day'] == peak_sal][['coffee_name','hour_of_day']]

# @title Q4 average sales amount(money)
df['money'].mean()

# @title Q5 the total sales per day
df.groupby(by = 'coffee_name')['Date'].sum().reset_index()

# @title Q6 total coffee sales transactions
df.groupby(by = 'coffee_name')['money'].sum().reset_index()

# @title Q7 the maximum and minimum sale amount
highest_sal = df['money'].max()
df[df['money'] == highest_sal][['coffee_name','money']]
highest_sal = df['money'].min()
df[df['money'] == highest_sal][['coffee_name','money']]

# @title Q8 month had the highest total coffee sales
highest_sal = df['Month_name'].max()
df[df['Month_name'] == highest_sal][['Month_name','money']]

# @title Q9 sales trends differ between weekdays and weekend
df.groupby(by = 'money')['Weekdaysort'].sum().reset_index()

# @title Q10 time of day  has the highest total sales
df.groupby(by = 'Time_of_Day')['money'].sum().reset_index()

# @title Q11 the average transaction value during each time of day
df.groupby('Time_of_Day')['money'].mean().reset_index()

import seaborn as sns
import matplotlib.pyplot as plt
sns.barplot(data=df, x='Time_of_Day', y='money', estimator='mean', ci=None)
plt.title('Average Transaction Value by Time of Day')
plt.ylabel('Average Transaction Value')
plt.xlabel('Time of Day')
plt.show()

# @title Q12 trend in sales growth across months
df.groupby('Monthsort')['money'].mean().reset_index()

# @title Q13  which coffee name is sold most
df['coffee_name'].value_counts()

# @title Q14 Does payment method (cash/card) affect average spending
'''
Solution:
Compare mean spend of card vs cash
'''
df.groupby("cash_type")["money"].mean()

# @title Q15 Which coffee type generates the highest revenue overall
'''Solution:
Group by coffee_name, sum money, then sort.
'''
df.groupby("coffee_name")["money"].sum().sort_values(ascending=False)
